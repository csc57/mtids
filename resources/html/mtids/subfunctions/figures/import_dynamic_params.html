<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of import_dynamic_params</title>
  <meta name="keywords" content="import_dynamic_params">
  <meta name="description" content="IMPORT_DYNAMIC_PARAMS gui for importing tempates to MTIDS">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="../../index.html">mtids</a> &gt; <a href="../index.html">subfunctions</a> &gt; <a href="index.html">figures</a> &gt; import_dynamic_params.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for mtids\subfunctions\figures&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>import_dynamic_params
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>IMPORT_DYNAMIC_PARAMS gui for importing tempates to MTIDS</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function varargout = import_dynamic_params(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">IMPORT_DYNAMIC_PARAMS gui for importing tempates to MTIDS

 This GUI reads in dynamic templates, which must obtain some exact
 specifications, concerning the input and output ports. Templates, which
 should be imported, may been desgined using the nodeTemplate.mdl-file, or
 following the exact naming of the ports, which are containd in
 nodeTemplate.mdl.

 INPUT:    (1) -- cell arry, containing blocks with editable numerical
                   parameters of template
           (2) -- cell array with according names of blocks in (1)
           (3) -- Filename of template
           (4) -- Pathname of template

 OUTPUT:   (none) -- After import is complete, template will be saved,
                       concatenating the postfix &quot;_CHECKED&quot;. This will 
                       enable the function &quot;readImportedTemplates&quot; to 
                       read-in all tested templates to MITDS.

 Author: Ferdinand Trommsdorff (f.trommsdorff@gmail.com)
 Project: MTIDS (http://code.google.com/p/mtids/)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../mtids/subfunctions/TextField1InputSpecs_Callback.html" class="code" title="function TextField1InputSpecs_Callback( hObject, evtdata, handles ) %#ok<INUSL>">TextField1InputSpecs_Callback</a>	TEXTFIELD1INPUTSPECS_CALLBACK consistency check for user edit field</li><li><a href="../../../mtids/subfunctions/TextField2InputSpecs_Callback.html" class="code" title="function TextField2InputSpecs_Callback( hObject, evtdata,handles ) %#ok<INUSD>">TextField2InputSpecs_Callback</a>	TEXTFIELD2INPUTSPECS consistency check for prompted user data</li><li><a href="../../../mtids/subfunctions/figResize.html" class="code" title="function figResize(src,evt,handles) %#ok<INUSL>">figResize</a>	FIGRESIZE figure resize function for pp2.fig</li><li><a href="../../../mtids/subfunctions/get_BlockParams.html" class="code" title="function [ paramname paramvalue ] = get_BlockParams( varargin )">get_BlockParams</a>	GET_BLOCKPARAMS block and parameter names for predefined block types</li><li><a href="../../../mtids/subfunctions/get_tableColumnWidth.html" class="code" title="function varargout = get_tableColumnWidth(varargin)">get_tableColumnWidth</a>	GET_TABLECOLUMNWIDTH estimates width of table</li><li><a href="../../../mtids/subfunctions/isValidData.html" class="code" title="function varargout = isValidData( varargin )">isValidData</a>	ISVALIDDATA Test prompted user data for feasiblity</li><li><a href="../../../mtids/subfunctions/matgraph/@graph/delete.html" class="code" title="function delete(g,i,j,dir)">delete</a>	delete --- delete vertices or edges from a graph</li><li><a href="../../../mtids/subfunctions/matgraph/@graph/size.html" class="code" title="function [sz,tz] = size(g)">size</a>	size(g) --- returns [nv,ne] for the graph</li><li><a href="../../../mtids/subfunctions/matgraph/@partition/size.html" class="code" title="function s = size(p)">size</a>	size(p) --- returns [nv,np]: number of vertices, parts.</li><li><a href="../../../mtids/subfunctions/newTablePosition.html" class="code" title="function newTablePosition( varargin )">newTablePosition</a>	NEWTABLEPOSITION set new layout position for import_dynamic_params</li><li><a href="../../../mtids/subfunctions/saveParamSet2File.html" class="code" title="function varargout = saveParamSet2File( varargin )">saveParamSet2File</a>	SAVEPARAMSET2FILE storing parameter set for a template</li><li><a href="../../../mtids/subfunctions/sizeChar2Pixel.html" class="code" title="function pixelValue = sizeChar2Pixel(hObject, widthOrHeight, input)">sizeChar2Pixel</a>	SIZECHAR2PIXEL conversion of char symbols to pixel size</li><li><a href="../../../mtids/subfunctions/testingValueSet.html" class="code" title="function varargout = testingValueSet( varargin )">testingValueSet</a>	TESTINGVALUESET checking numerical parameters of template</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../mtids/mtids.html" class="code" title="function varargout = mtids(varargin)">mtids</a>	MTIDS Version 1.2</li><li><a href="../../../mtids/sandkasten/test_import_dynamic_parameters.html" class="code" title="">test_import_dynamic_parameters</a>	IMPORTDYNAMICPARAMS standalone test script for import_dynamic_params.m</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function import_dynamic_params_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = import_dynamic_params_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function pushbutton1_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function pushbutton2_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function pushbutton3_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function pushbutton4_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function pushbutton5_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function pushbutton6_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function fig_importTemplate_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function height = get_figureHeight( nrBlks )</a></li><li><a href="#_sub11" class="code">function table_CellSelectionCallback(src,evt,handles)</a></li><li><a href="#_sub12" class="code">function table_CellEditCallbackFcn(src,evt,handles)</a></li><li><a href="#_sub13" class="code">function geo_params = get_initialGeometry</a></li><li><a href="#_sub14" class="code">function TextField2InputSpecs_Callback( src,evt,handles )</a></li><li><a href="#_sub15" class="code">function EditFieldSetName_Callback( src,evt,handles )</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = import_dynamic_params(varargin)</a>
0002 <span class="comment">%IMPORT_DYNAMIC_PARAMS gui for importing tempates to MTIDS</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% This GUI reads in dynamic templates, which must obtain some exact</span>
0005 <span class="comment">% specifications, concerning the input and output ports. Templates, which</span>
0006 <span class="comment">% should be imported, may been desgined using the nodeTemplate.mdl-file, or</span>
0007 <span class="comment">% following the exact naming of the ports, which are containd in</span>
0008 <span class="comment">% nodeTemplate.mdl.</span>
0009 <span class="comment">%</span>
0010 <span class="comment">% INPUT:    (1) -- cell arry, containing blocks with editable numerical</span>
0011 <span class="comment">%                   parameters of template</span>
0012 <span class="comment">%           (2) -- cell array with according names of blocks in (1)</span>
0013 <span class="comment">%           (3) -- Filename of template</span>
0014 <span class="comment">%           (4) -- Pathname of template</span>
0015 <span class="comment">%</span>
0016 <span class="comment">% OUTPUT:   (none) -- After import is complete, template will be saved,</span>
0017 <span class="comment">%                       concatenating the postfix &quot;_CHECKED&quot;. This will</span>
0018 <span class="comment">%                       enable the function &quot;readImportedTemplates&quot; to</span>
0019 <span class="comment">%                       read-in all tested templates to MITDS.</span>
0020 <span class="comment">%</span>
0021 <span class="comment">% Author: Ferdinand Trommsdorff (f.trommsdorff@gmail.com)</span>
0022 <span class="comment">% Project: MTIDS (http://code.google.com/p/mtids/)</span>
0023 
0024 <span class="comment">%      IMPORT_DYNAMIC_PARAMS, by itself, creates a new IMPORT_DYNAMIC_PARAMS or raises the existing</span>
0025 <span class="comment">%      singleton*.</span>
0026 <span class="comment">%</span>
0027 <span class="comment">%      H = IMPORT_DYNAMIC_PARAMS returns the handle to a new IMPORT_DYNAMIC_PARAMS or the handle to</span>
0028 <span class="comment">%      the existing singleton*.</span>
0029 <span class="comment">%</span>
0030 <span class="comment">%      IMPORT_DYNAMIC_PARAMS('CALLBACK',hObject,eventData,handles,...) calls the local</span>
0031 <span class="comment">%      function named CALLBACK in IMPORT_DYNAMIC_PARAMS.M with the given input arguments.</span>
0032 <span class="comment">%</span>
0033 <span class="comment">%      IMPORT_DYNAMIC_PARAMS('Property','Value',...) creates a new IMPORT_DYNAMIC_PARAMS or raises the</span>
0034 <span class="comment">%      existing singleton*.  Starting from the left, property value pairs are</span>
0035 <span class="comment">%      applied to the GUI before import_dynamic_params_OpeningFcn gets called.  An</span>
0036 <span class="comment">%      unrecognized property name or invalid value makes property application</span>
0037 <span class="comment">%      stop.  All inputs are passed to import_dynamic_params_OpeningFcn via varargin.</span>
0038 <span class="comment">%</span>
0039 <span class="comment">%      *See GUI Options on GUIDE's Tools menu.  Choose &quot;GUI allows only one</span>
0040 <span class="comment">%      instance to run (singleton)&quot;.</span>
0041 <span class="comment">%</span>
0042 <span class="comment">% See also: GUIDE, GUIDATA, GUIHANDLES</span>
0043 
0044 <span class="comment">% Edit the above text to modify the response to help import_dynamic_params</span>
0045 
0046 <span class="comment">% Last Modified by GUIDE v2.5 18-Sep-2012 11:23:12</span>
0047 
0048 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0049 gui_Singleton = 1;
0050 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0051                    <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0052                    <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction import_dynamic_params_OpeningFcn(hObject, eventdata, handles, varargin)">import_dynamic_params_OpeningFcn</a>, <span class="keyword">...</span>
0053                    <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = import_dynamic_params_OutputFcn(hObject, eventdata, handles)  ">import_dynamic_params_OutputFcn</a>, <span class="keyword">...</span>
0054                    <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0055                    <span class="string">'gui_Callback'</span>,   []);
0056 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0057     gui_State.gui_Callback = str2func(varargin{1});
0058 <span class="keyword">end</span>
0059 
0060 <span class="keyword">if</span> nargout
0061     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0062 <span class="keyword">else</span>
0063     gui_mainfcn(gui_State, varargin{:});
0064 <span class="keyword">end</span>
0065 <span class="comment">% End initialization code - DO NOT EDIT</span>
0066 
0067 
0068 <span class="comment">% --- Executes just before import_dynamic_params is made visible.</span>
0069 <a name="_sub1" href="#_subfunctions" class="code">function import_dynamic_params_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0070 <span class="comment">% This function has no output args, see OutputFcn.</span>
0071 <span class="comment">% hObject    handle to figure</span>
0072 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0073 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0074 <span class="comment">% varargin   command line arguments to import_dynamic_params (see VARARGIN)</span>
0075 
0076 <span class="comment">%% Callback Functions</span>
0077 
0078 <span class="comment">% Choose default command line output for import_dynamic_params</span>
0079 handles.output = hObject;
0080 
0081 listBlks = varargin{1};
0082 listnms = varargin{2};
0083 filename = varargin{3};
0084 handles.pathname = varargin{4};
0085 m=regexp( filename, <span class="string">'\.'</span>, <span class="string">'split'</span>,<span class="string">'once'</span>);
0086 handles.sysname = m{1};
0087 <span class="comment">% flag if testing param set was successful</span>
0088 handles.testSuccess = 0;
0089 
0090 <span class="comment">%% Geometry</span>
0091 screenSize = get( 0, <span class="string">'ScreenSize'</span> );
0092 topFrame = 30;
0093 bottomFrame = 0.5*topFrame;
0094 sideFrame = 0.5*topFrame;
0095 
0096 nrBlks = length(listBlks);
0097 
0098 topGap = 1/12*screenSize(4);
0099 left = screenSize(3)*0.1;
0100 <span class="comment">% Compute height only depending on the table</span>
0101 height = <a href="#_sub10" class="code" title="subfunction height = get_figureHeight( nrBlks )">get_figureHeight</a>( nrBlks );
0102 
0103 <span class="keyword">if</span> screenSize(3)*0.9 &gt; 760
0104     width = 760;
0105 <span class="keyword">else</span>
0106     width = screenSize(3)*0.85;
0107 <span class="keyword">end</span>
0108 
0109 bottom = screenSize(4) - topGap - height;
0110 posVector = [left bottom width height]; <span class="comment">%do this dynamically % [left, bottom, width, height]</span>
0111 
0112 
0113 <span class="comment">%% Creating Figure</span>
0114 
0115 <span class="comment">% creating elements</span>
0116 handles.uipanel1 = uipanel;
0117 handles.t = uitable;
0118 handles.PanelTextInputSpecs = uipanel;
0119 handles.PanelSetName = uipanel;
0120 handles.TextField1InputSpecs = uicontrol;
0121 handles.TextField2InputSpecs = uicontrol;
0122 handles.TextField1Descrptn = uicontrol;
0123 handles.TextField2Descrptn = uicontrol;
0124 handles.TextFieldSetNameHelp = uicontrol;
0125 handles.EditFieldSetName = uicontrol;
0126 <span class="comment">% handles.textBlockType = uicontrol;</span>
0127 
0128 <span class="comment">% setting figure parameters manually</span>
0129 defaultBackground = get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>);
0130 <span class="comment">% save('posVecFigure','posVector');</span>
0131 set(handles.fig_importTemplate,<span class="string">'Position'</span>,posVector,<span class="string">'Name'</span>,<span class="string">'Import Dynamic Wizard'</span>,<span class="string">'Toolbar'</span>,<span class="string">'none'</span>,<span class="keyword">...</span>
0132     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>,<span class="string">'Resize'</span>,<span class="string">'on'</span>,<span class="string">'ResizeFcn'</span>,{@<a href="../../../mtids/subfunctions/figResize.html" class="code" title="function figResize(src,evt,handles) %#ok<INUSL>">figResize</a>,handles},<span class="string">'Color'</span>,<span class="keyword">...</span>
0133     defaultBackground,<span class="string">'Units'</span>,<span class="string">'pixels'</span>);<span class="comment">%,'CloseRequestFcn',{@figure1_CloseRequestFcn,handles});</span>
0134 
0135 
0136 <span class="comment">%% Filling the data cells</span>
0137 dat = cell(length(listBlks),3);
0138 dat(:,1) = listnms;
0139 <span class="keyword">for</span> i = 1:length(listBlks)
0140     <span class="comment">% if there are well known block types here, we can provide some</span>
0141     <span class="comment">% initialisation of the table. If not, declare parameters names</span>
0142     <span class="comment">% otherwise</span>
0143     [ paramname paramvalue ] = <a href="../../../mtids/subfunctions/get_BlockParams.html" class="code" title="function [ paramname paramvalue ] = get_BlockParams( varargin )">get_BlockParams</a>( listBlks{i},handles,listnms{i} );
0144     <span class="comment">% Filling the data cells</span>
0145     <span class="keyword">for</span> j = 1:length(paramname)
0146         dat{i,2*j} = paramname{j};
0147         dat{i,1+2*j} = paramvalue{j};
0148     <span class="keyword">end</span>
0149 <span class="keyword">end</span>
0150 
0151 <span class="comment">%% Set Column names and &quot;edit cell&quot; properties</span>
0152 cnames = cell( <a href="../../../mtids/subfunctions/matgraph/@graph/size.html" class="code" title="function [sz,tz] = size(g)">size</a>(dat,2) , 1 );
0153 cnames{1} = <span class="string">'Block Name'</span>;
0154 columneditable = logical( zeros(1, <a href="../../../mtids/subfunctions/matgraph/@graph/size.html" class="code" title="function [sz,tz] = size(g)">size</a>(dat,2) )); <span class="comment">%#ok&lt;LOGL&gt;</span>
0155 <span class="keyword">for</span> i = 1:floor( <a href="../../../mtids/subfunctions/matgraph/@graph/size.html" class="code" title="function [sz,tz] = size(g)">size</a>(dat,2) / 2)
0156     cnames{2*i} = <span class="string">'Parameter Name'</span>;
0157     cnames{2*i + 1} = <span class="string">'Value'</span>;
0158     columneditable(2*i) = false;
0159     columneditable(2*i + 1) = true;
0160 <span class="keyword">end</span>
0161 columnformat = repmat( {<span class="string">'char'</span>}, 1,<a href="../../../mtids/subfunctions/matgraph/@graph/size.html" class="code" title="function [sz,tz] = size(g)">size</a>(dat,2) );
0162 
0163 <span class="comment">%% Column and cell format computations</span>
0164 <span class="comment">% width of table should be adapted on content or column cells</span>
0165 <span class="comment">% idea: compute number of symbols which are spread horizontally</span>
0166 heightTable = 1.25*<a href="../../../mtids/subfunctions/sizeChar2Pixel.html" class="code" title="function pixelValue = sizeChar2Pixel(hObject, widthOrHeight, input)">sizeChar2Pixel</a>(handles.fig_importTemplate, <span class="string">'h'</span>, ( nrBlks + 2 ) );
0167 [ widthTable columnwidth] = <a href="../../../mtids/subfunctions/get_tableColumnWidth.html" class="code" title="function varargout = get_tableColumnWidth(varargin)">get_tableColumnWidth</a>(handles.fig_importTemplate,listBlks,dat,cnames);
0168 widthFigure = widthTable + 140;
0169 
0170 <span class="comment">%% Prepare table position properties</span>
0171 posVecTable = [1.5*sideFrame 5*bottomFrame widthTable heightTable]; <span class="comment">% [left, bottom, width, height]</span>
0172 <span class="keyword">if</span> widthFigure &gt; screenSize(3)
0173     widthFigure = screenSize(3);
0174     posVector(1) = 0;
0175 <span class="keyword">end</span>
0176 
0177 <span class="comment">%% Creating Figure Content</span>
0178 posVector(3) = widthFigure;
0179 set(handles.fig_importTemplate,<span class="string">'Position'</span>,posVector);
0180 
0181 <span class="comment">% parameters for panel, in which all other control elements are positioned</span>
0182 <span class="comment">% posVectorPanel = get_panelPosition(widthTable, height);</span>
0183 posVectorPanel = [sideFrame bottomFrame width-2*sideFrame height-topFrame]; <span class="comment">% [left, bottom, width, height]</span>
0184 
0185 <span class="comment">% save('posVecPanel','posVectorPanel');</span>
0186 set(handles.uipanel1,<span class="string">'Parent'</span>,handles.fig_importTemplate,<span class="string">'Title'</span>,[<span class="string">'Collecting parameters for model '''</span>,<span class="keyword">...</span>
0187     handles.sysname char(39)],<span class="string">'Units'</span>,<span class="string">'pixel'</span>,<span class="string">'Position'</span>,posVectorPanel);
0188 
0189 set(handles.t,<span class="string">'Units'</span>,<span class="string">'pixel'</span>);
0190 <span class="comment">% save('posVecTable');</span>
0191 set(handles.t,<span class="string">'RowName'</span>,listBlks,<span class="string">'ColumnName'</span>,cnames,<span class="string">'Position'</span>,posVecTable,<span class="keyword">...</span>
0192     <span class="string">'ColumnWidth'</span>,columnwidth,<span class="string">'Data'</span>,dat, <span class="string">'ColumnEditable'</span>, columneditable,<span class="keyword">...</span>
0193     <span class="string">'BackgroundColor'</span>,[1 1 1],<span class="string">'ColumnFormat'</span>,columnformat,<span class="string">'CellSelectionCallback'</span>,<span class="keyword">...</span>
0194     {@<a href="#_sub11" class="code" title="subfunction table_CellSelectionCallback(src,evt,handles)">table_CellSelectionCallback</a>,handles},<span class="string">'CellEditCallback'</span>,<span class="keyword">...</span>
0195     {@<a href="#_sub12" class="code" title="subfunction table_CellEditCallbackFcn(src,evt,handles) ">table_CellEditCallbackFcn</a>,handles});
0196 
0197 <span class="comment">%% parameters for pushbuttons</span>
0198 horPosPushbutton1 = 0.1*widthFigure;
0199 posVectorSubmitButton = [horPosPushbutton1 5.0*bottomFrame 120 35];
0200 set(handles.pushbutton1,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="string">'Position'</span>,posVectorSubmitButton,<span class="keyword">...</span>
0201     <span class="string">'String'</span>,<span class="string">'Add Block'</span>);
0202 
0203 horPosPushbutton2 = 0.1*widthFigure;
0204 posVectorCancelButton = [horPosPushbutton2 1.7*bottomFrame 120 35];
0205 set(handles.pushbutton2,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="string">'String'</span>,<span class="string">'Remove Block'</span>,<span class="keyword">...</span>
0206                 <span class="string">'Position'</span>,posVectorCancelButton);
0207 
0208 horPosPushbutton3 = 0.4*widthFigure;
0209 posVectorAddParamButton = [horPosPushbutton3 5.0*bottomFrame 120 35];
0210 set(handles.pushbutton3,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="string">'String'</span>,<span class="string">'Add Parameter'</span>,<span class="keyword">...</span>
0211                 <span class="string">'Position'</span>,posVectorAddParamButton);
0212             
0213 horPosPushbutton4 = 0.4*widthFigure;
0214 posVectorDebugButton = [horPosPushbutton4 1.7*bottomFrame 120 35];
0215 set(handles.pushbutton4,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="string">'String'</span>,<span class="string">'Remove Parameter'</span>,<span class="keyword">...</span>
0216                 <span class="string">'Position'</span>,posVectorDebugButton);
0217             
0218 horPosPushbutton5 = 0.7*widthFigure;
0219 posVectorDebugButton1 = [horPosPushbutton5 5.0*bottomFrame 120 35];
0220 set(handles.pushbutton5,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="string">'String'</span>,<span class="string">'Test Value Set'</span>,<span class="keyword">...</span>
0221                 <span class="string">'Position'</span>,posVectorDebugButton1);
0222             
0223 horPosPushbutton6 = 0.7*widthFigure;
0224 posVectorFinishButton = [horPosPushbutton6 1.7*bottomFrame 120 35];
0225 set(handles.pushbutton6,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="string">'String'</span>,<span class="string">'Finish Import'</span>,<span class="keyword">...</span>
0226     <span class="string">'Position'</span>,posVectorFinishButton);
0227 
0228 <span class="comment">%% Text fields for input specifications</span>
0229 <span class="comment">% Position of design elements</span>
0230 posVecPanelTextInputSpecs = [2*sideFrame 5.5*bottomFrame+35 width-2*sideFrame 50]; <span class="comment">% [left, bottom, width, height]</span>
0231 posVecPanelSetName = [2*sideFrame 5.5*bottomFrame+95 width-2*sideFrame 50];
0232 posVecTextFieldSetNameHelp = [10 3 200 30];
0233 posVecEditFieldSetName = [210 3 200 30];
0234 <span class="comment">% posVecTextField1InputSpecs ('Style': edit)</span>
0235 posVecTextField1InputSpecs = [200 8 80 22];
0236 <span class="comment">% posVecTextField2InputSpecs ('Style': edit)</span>
0237 posVecTextField2InputSpecs = [440 8 80 22];
0238 <span class="comment">% posVecTextField1Descrptn ('Style': text )</span>
0239 posVecTextField1Descrptn = [10 3 200 30];
0240 <span class="comment">% posVecTextField2Descrptn ('Style': text )</span>
0241 posVecTextField2Descrptn = [290 3 140 30];
0242 
0243 <span class="comment">% Setting design elements</span>
0244 set(handles.PanelTextInputSpecs,<span class="string">'Parent'</span>,handles.fig_importTemplate,<span class="string">'Title'</span>,<span class="string">'Input Specifications'</span>,<span class="keyword">...</span>
0245     <span class="string">'Units'</span>,<span class="string">'pixel'</span>,<span class="string">'Position'</span>,posVecPanelTextInputSpecs);
0246 set(handles.PanelSetName,<span class="string">'Parent'</span>,handles.fig_importTemplate,<span class="string">'Title'</span>,<span class="string">'Name for parameter set'</span>,<span class="keyword">...</span>
0247     <span class="string">'Units'</span>,<span class="string">'pixel'</span>,<span class="string">'Position'</span>,posVecPanelSetName);
0248 TextFieldSetNameHelp_String = <span class="string">'Use significant names for different value sets:'</span>;
0249 set(handles.TextFieldSetNameHelp,<span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'Parent'</span>,handles.PanelSetName,<span class="keyword">...</span>
0250     <span class="string">'Units'</span>,<span class="string">'pixel'</span>,<span class="string">'Position'</span>,posVecTextFieldSetNameHelp,<span class="string">'String'</span>,TextFieldSetNameHelp_String);
0251 <span class="comment">% % check number of still existing value sets</span>
0252 <span class="comment">% if exist([handles.sysname '_paramValues.mat'],'file')</span>
0253 <span class="comment">%     load([handles.sysname '_paramValues.mat']);</span>
0254 <span class="comment">%     % check if the paramSet still exists</span>
0255 <span class="comment">%     eval(['idx = length( ' answer{1} '_paramValues);']);</span>
0256 <span class="comment">% end</span>
0257 editFieldSetNameInitString = <span class="string">'Value Set #'</span>;
0258 set(handles.EditFieldSetName,<span class="string">'Parent'</span>,handles.PanelSetName,<span class="keyword">...</span>
0259     <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'Units'</span>,<span class="string">'pixel'</span>,<span class="string">'Position'</span>,posVecEditFieldSetName,<span class="keyword">...</span>
0260     <span class="string">'BackgroundColor'</span>,[1 1 1],<span class="string">'Callback'</span>,{@<a href="#_sub15" class="code" title="subfunction EditFieldSetName_Callback( src,evt,handles )">EditFieldSetName_Callback</a>,handles},<span class="keyword">...</span>
0261     <span class="string">'String'</span>,editFieldSetNameInitString);
0262 set(handles.TextField1InputSpecs,<span class="string">'Parent'</span>,handles.PanelTextInputSpecs,<span class="keyword">...</span>
0263     <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'Units'</span>,<span class="string">'pixel'</span>,<span class="string">'Position'</span>,posVecTextField1InputSpecs,<span class="keyword">...</span>
0264     <span class="string">'BackgroundColor'</span>,[1 1 1],<span class="string">'Callback'</span>,{@<a href="../../../mtids/subfunctions/TextField1InputSpecs_Callback.html" class="code" title="function TextField1InputSpecs_Callback( hObject, evtdata, handles ) %#ok<INUSL>">TextField1InputSpecs_Callback</a>,handles});
0265 TextField1Descrptn_String = <span class="string">'Linear depending parameters on number of external inputs:'</span>;
0266 set(handles.TextField1Descrptn,<span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'Parent'</span>,handles.PanelTextInputSpecs,<span class="keyword">...</span>
0267     <span class="string">'Units'</span>,<span class="string">'pixel'</span>,<span class="string">'Position'</span>,posVecTextField1Descrptn,<span class="string">'String'</span>,TextField1Descrptn_String);
0268 TextField2Descrptn_String = <span class="string">'Thereof number of internal inputs:'</span>;
0269 set(handles.TextField2Descrptn,<span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'Parent'</span>,handles.PanelTextInputSpecs,<span class="keyword">...</span>
0270     <span class="string">'Units'</span>,<span class="string">'pixel'</span>,<span class="string">'Position'</span>,posVecTextField2Descrptn,<span class="string">'String'</span>,TextField2Descrptn_String);
0271 set(handles.TextField2InputSpecs,<span class="string">'Parent'</span>,handles.PanelTextInputSpecs,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="keyword">...</span>
0272     <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'Units'</span>,<span class="string">'pixel'</span>,<span class="string">'Position'</span>,posVecTextField2InputSpecs,<span class="keyword">...</span>
0273     <span class="string">'BackgroundColor'</span>,[1 1 1],<span class="string">'Callback'</span>,{@<a href="../../../mtids/subfunctions/TextField2InputSpecs_Callback.html" class="code" title="function TextField2InputSpecs_Callback( hObject, evtdata,handles ) %#ok<INUSD>">TextField2InputSpecs_Callback</a>,handles});
0274 
0275 <span class="comment">% handles.handles.textBlockType = uicontrol('Style','text','FontWeight','demi','FontSize',10,...</span>
0276 <span class="comment">%     'Position',[45 height-1.725*topFrame 100 18],... % [left, bottom, width, height]</span>
0277 <span class="comment">%     'String','Block Type');</span>
0278 <span class="comment">%</span>
0279 <span class="comment">% &quot;Dirty&quot;: Prompt Block Type above the row names</span>
0280 <span class="comment">% set(handles.textBlockType,'Style','text','FontWeight','demi','FontSize',10,...</span>
0281 <span class="comment">%     'Position',[45 height-1.725*topFrame 100 18],... % [left, bottom, width, height]</span>
0282 <span class="comment">%     'String','Block Type');</span>
0283 <span class="comment">% uistack(handles.textBlockType,'top');</span>
0284 
0285 <span class="comment">% Update handles structure</span>
0286 guidata(handles.fig_importTemplate, handles);
0287 
0288 <span class="comment">% UIWAIT makes import_dynamic_params wait for user response (see UIRESUME)</span>
0289 uiwait(handles.fig_importTemplate);
0290 
0291 
0292 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0293 <a name="_sub2" href="#_subfunctions" class="code">function varargout = import_dynamic_params_OutputFcn(hObject, eventdata, handles)  </a><span class="comment">%#ok&lt;INUSD&gt;</span>
0294 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0295 <span class="comment">% hObject    handle to figure</span>
0296 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0297 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0298 <span class="comment">% Get default command line output from handles structure</span>
0299 varargout{1} = 1; <span class="comment">%handles.output;</span>
0300 
0301 
0302 <span class="comment">% --- Executes on button press in pushbutton1. ADD BLOCK</span>
0303 <a name="_sub3" href="#_subfunctions" class="code">function pushbutton1_Callback(hObject, eventdata, handles)</a>
0304 <span class="comment">% hObject    handle to pushbutton1 (see GCBO)</span>
0305 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0306 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0307 
0308 <span class="comment">% determine length of row labeling vector</span>
0309 nrOfRows = length( get(handles.t,<span class="string">'RowName'</span>) );
0310 
0311 <span class="comment">% ask for new row (=block) name</span>
0312 newRowName = inputdlg({<span class="string">'New Block Type: '</span>},<span class="string">'Add Block'</span>,1);
0313 <span class="keyword">if</span> isempty( newRowName )
0314     <span class="keyword">return</span>;
0315 <span class="keyword">end</span>
0316 <span class="comment">% check if block type exists before adding the row to the table</span>
0317 <span class="keyword">if</span> isempty( find_system(handles.sysname,<span class="string">'BlockType'</span>,newRowName{1}) )
0318     errordlg([<span class="string">'No Block of Type '</span>,newRowName,<span class="string">' found!'</span>]);
0319     <span class="keyword">return</span>;
0320 <span class="keyword">end</span>
0321 
0322 <span class="comment">% Data processing to row names and table data</span>
0323 rownames = cell(nrOfRows+1,1);
0324 rownames(1:nrOfRows) = get(handles.t,<span class="string">'RowName'</span>);
0325 rownames(end) = newRowName;
0326 testCell=find_system(handles.sysname,<span class="string">'BlockType'</span>,newRowName{1});
0327 s=regexp(testCell,<span class="string">'/'</span>,<span class="string">'split'</span>);
0328 listOutString = cell(<a href="../../../mtids/subfunctions/matgraph/@graph/size.html" class="code" title="function [sz,tz] = size(g)">size</a>(s,1),1);
0329 <span class="keyword">for</span> i = 1:<a href="../../../mtids/subfunctions/matgraph/@graph/size.html" class="code" title="function [sz,tz] = size(g)">size</a>(s,1)
0330     listOutString{i} = s{i}{2};
0331 <span class="keyword">end</span>
0332 listsize = [1.2*<a href="../../../mtids/subfunctions/sizeChar2Pixel.html" class="code" title="function pixelValue = sizeChar2Pixel(hObject, widthOrHeight, input)">sizeChar2Pixel</a>(hObject,<span class="string">'w'</span>, 3+max(cellfun(@length,listOutString))) <span class="keyword">...</span>
0333     1.2*<a href="../../../mtids/subfunctions/sizeChar2Pixel.html" class="code" title="function pixelValue = sizeChar2Pixel(hObject, widthOrHeight, input)">sizeChar2Pixel</a>(hObject,<span class="string">'h'</span>,<a href="../../../mtids/subfunctions/matgraph/@graph/size.html" class="code" title="function [sz,tz] = size(g)">size</a>(listOutString,1)+1 )];
0334 newBlockNameIndex = listdlg(<span class="string">'PromptString'</span>,<span class="string">'Select a Block Name:'</span>,<span class="keyword">...</span>
0335     <span class="string">'SelectionMode'</span>,<span class="string">'single'</span>,<span class="string">'ListSize'</span>,listsize,<span class="keyword">...</span>
0336     <span class="string">'ListString'</span>,listOutString);
0337 dataOld=get(handles.t,<span class="string">'Data'</span>);
0338 dataNew = cell( <a href="../../../mtids/subfunctions/matgraph/@graph/size.html" class="code" title="function [sz,tz] = size(g)">size</a>(dataOld,1)+1, <a href="../../../mtids/subfunctions/matgraph/@graph/size.html" class="code" title="function [sz,tz] = size(g)">size</a>(dataOld,2) );
0339 dataNew(1:end-1,:) = dataOld;
0340 newBlockName = listOutString(newBlockNameIndex);
0341 [ paramname paramvalue ] = <a href="../../../mtids/subfunctions/get_BlockParams.html" class="code" title="function [ paramname paramvalue ] = get_BlockParams( varargin )">get_BlockParams</a>( newRowName{:},handles,newBlockName{:} );
0342 dataNew(<span class="keyword">end</span>,1) = listOutString(newBlockNameIndex);
0343 <span class="keyword">for</span> j = 1:length(paramname)
0344     dataNew{<span class="keyword">end</span>,2*j} = paramname{j};
0345     dataNew{<span class="keyword">end</span>,1+2*j} = paramvalue{j};
0346 <span class="keyword">end</span>
0347 
0348 <span class="comment">% Computing new positions</span>
0349 <a href="../../../mtids/subfunctions/newTablePosition.html" class="code" title="function newTablePosition( varargin )">newTablePosition</a>( handles,eventdata, rownames, dataNew );
0350 
0351 
0352 <span class="comment">% --- Executes on button press in pushbutton2. REMOVE BLOCK</span>
0353 <a name="_sub4" href="#_subfunctions" class="code">function pushbutton2_Callback(hObject, eventdata, handles)</a>
0354 <span class="comment">% hObject    handle to pushbutton2 (see GCBO)</span>
0355 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0356 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0357 
0358 <span class="comment">% Case handling: if no cells are selected</span>
0359 <span class="keyword">try</span>
0360     <span class="keyword">if</span> isempty(handles.selected_cells)
0361         errordlg(<span class="string">'No row(s) selected'</span>);
0362         <span class="keyword">return</span>
0363     <span class="keyword">end</span>
0364     IDX = handles.selected_cells; <span class="comment">% Contains indices of the selected cells</span>
0365     rowIDX = IDX(:,1);
0366     <span class="comment">% colIDX = IDX(:,2);</span>
0367     rownames = get(handles.t,<span class="string">'RowName'</span>);
0368     <span class="comment">% Perform request if cells should really be deleted</span>
0369     title = <span class="string">'Sure? Delete block(s)?'</span>;
0370     qstring = {<span class="string">'Should the following blocks be deleted?'</span>,<span class="keyword">...</span>
0371         rownames{rowIDX} };
0372     choice = questdlg(qstring,title,<span class="string">'Yes'</span>,<span class="string">'No'</span>,<span class="string">'No'</span>);
0373     <span class="keyword">switch</span> choice
0374         <span class="keyword">case</span> <span class="string">'Yes'</span>;
0375             <span class="comment">% adapt rownames</span>
0376             rownamesIDX = 1:1:length(rownames);
0377             <span class="comment">% delete rowname indices according to selected cells</span>
0378             <span class="keyword">for</span> ii = 1:length(rowIDX)
0379                 rownamesIDX = rownamesIDX(rownamesIDX ~= rowIDX(ii));
0380             <span class="keyword">end</span>
0381             rownamesNew = rownames( rownamesIDX );
0382             <span class="comment">% adapt table data</span>
0383             data=get(handles.t,<span class="string">'Data'</span>);
0384             data = data( rownamesIDX,: );
0385             <span class="comment">% set new table</span>
0386             <a href="../../../mtids/subfunctions/newTablePosition.html" class="code" title="function newTablePosition( varargin )">newTablePosition</a>( handles,eventdata, rownamesNew, data );
0387         <span class="keyword">case</span> <span class="string">'No'</span>;
0388             <span class="comment">% do nothing</span>
0389     <span class="keyword">end</span>
0390 <span class="keyword">catch</span>
0391     errordlg(<span class="string">'No row(s) selected'</span>);
0392     <span class="keyword">return</span>
0393 <span class="keyword">end</span>
0394 
0395 <span class="comment">% --- Executes on button press in pushbutton3. ADD PARAMETER</span>
0396 <a name="_sub5" href="#_subfunctions" class="code">function pushbutton3_Callback(hObject, eventdata, handles)</a>
0397 <span class="comment">% hObject    handle to pushbutton3 (see GCBO)</span>
0398 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0399 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0400 <span class="comment">% Case handling: if no cells are selected</span>
0401 
0402 <span class="keyword">if</span> ~isfield(handles,<span class="string">'selected_cells'</span>) || isempty(handles.selected_cells)
0403     errordlg(<span class="string">'No row(s) selected'</span>);
0404     <span class="keyword">return</span>
0405 <span class="keyword">end</span>
0406 IDX = handles.selected_cells; <span class="comment">% Contains indices of the selected cells</span>
0407 rowIDX = IDX(:,1);
0408 <span class="comment">% colIDX = IDX(:,2);</span>
0409 <span class="keyword">if</span> <a href="../../../mtids/subfunctions/matgraph/@graph/size.html" class="code" title="function [sz,tz] = size(g)">size</a>( rowIDX,1 ) &gt; 1
0410     errordlg(<span class="string">'Please choose only one block for adding a new parameter'</span>);
0411     <span class="keyword">return</span>
0412 <span class="keyword">end</span>
0413 
0414 <span class="comment">% Dialog if parameter out of list should be chosen or via free hand input</span>
0415 <span class="comment">% Construct a questdlg with three options</span>
0416 choice = questdlg(<span class="string">'How should the parameter be chosen?'</span>, <span class="keyword">...</span>
0417  <span class="string">'Add Parameter Menu'</span>, <span class="keyword">...</span>
0418  <span class="string">'Out of list'</span>,<span class="string">'Free input'</span>,<span class="string">'Cancel'</span>,<span class="string">'Cancel'</span>);
0419 <span class="comment">% Handle response</span>
0420 cellData = get(handles.t,<span class="string">'Data'</span>);
0421 <span class="keyword">switch</span> choice
0422     <span class="keyword">case</span> <span class="string">'Out of list'</span>
0423         <span class="comment">% Show list with available parameters</span>
0424         allParams = get_param([handles.sysname <span class="string">'/'</span> cellData{rowIDX,1}],<span class="string">'Dialogparameters'</span>);
0425         namesAllParams = fieldnames( allParams );
0426         listsize = [1.4*<a href="../../../mtids/subfunctions/sizeChar2Pixel.html" class="code" title="function pixelValue = sizeChar2Pixel(hObject, widthOrHeight, input)">sizeChar2Pixel</a>(hObject,<span class="string">'w'</span>, 3+max(cellfun(@length,namesAllParams))) <span class="keyword">...</span>
0427             1.3*<a href="../../../mtids/subfunctions/sizeChar2Pixel.html" class="code" title="function pixelValue = sizeChar2Pixel(hObject, widthOrHeight, input)">sizeChar2Pixel</a>(hObject,<span class="string">'h'</span>,<a href="../../../mtids/subfunctions/matgraph/@graph/size.html" class="code" title="function [sz,tz] = size(g)">size</a>(namesAllParams,1)+1 )];
0428         newParamIndex = listdlg(<span class="string">'PromptString'</span>,<span class="string">'Select a parameter:'</span>,<span class="keyword">...</span>
0429             <span class="string">'SelectionMode'</span>,<span class="string">'single'</span>,<span class="string">'ListSize'</span>,listsize,<span class="keyword">...</span>
0430             <span class="string">'ListString'</span>,namesAllParams);
0431         <span class="keyword">if</span> isempty( newParamIndex )
0432             <span class="keyword">return</span>;
0433         <span class="keyword">end</span>
0434         answer(1) = namesAllParams( newParamIndex );
0435 <span class="comment">%         rowname = get(handles.t,'RowName');</span>
0436 <span class="comment">%         prompt = {'Enter parameter value:'};</span>
0437 <span class="comment">%         title = ['New Parameter Name in Block ',rowname{rowIDX}];</span>
0438 <span class="comment">%         num_lines = 1;</span>
0439 <span class="comment">%         def = {'paramvalue'};</span>
0440 <span class="comment">%         answer(2) = inputdlg(prompt,title,num_lines,def);</span>
0441         paramvalue = get_param([handles.sysname,<span class="string">'/'</span>,cellData{ rowIDX,1 } ],answer{1});
0442     <span class="keyword">case</span> <span class="string">'Free input'</span>
0443         rowname = get(handles.t,<span class="string">'RowName'</span>);
0444         <span class="comment">% Perform request if parameter should be added</span>
0445         prompt = {<span class="string">'Enter parameter name:'</span>};
0446         title = [<span class="string">'Add new Parameter to Block '</span>,rowname{rowIDX}];
0447         num_lines = 1;
0448         def = {<span class="string">'paramname'</span>};
0449         answer = inputdlg(prompt,title,num_lines,def);
0450         <span class="comment">% Check if parameter name really exists; if not, throw error</span>
0451         <span class="keyword">try</span>
0452             paramvalue = get_param([handles.sysname,<span class="string">'/'</span>,cellData{ rowIDX,1 } ],answer{1});
0453         <span class="keyword">catch</span>
0454             errordlg([<span class="string">'Parameter '</span>,answer{1},<span class="string">' not found for block '</span>,cellData{ rowIDX,1 },<span class="string">'!'</span>]);
0455             <span class="keyword">return</span>
0456         <span class="keyword">end</span>
0457     <span class="keyword">case</span> <span class="string">'Cancel'</span>
0458         <span class="keyword">return</span>;
0459 <span class="keyword">end</span>
0460 
0461 <span class="keyword">if</span> ~isempty( answer{1} ) &amp;&amp; ~isempty( paramvalue )
0462     cellData = get(handles.t,<span class="string">'Data'</span>);
0463     <span class="comment">% Determine next free position in cell data</span>
0464     <span class="comment">% Check for length AND last empty cell</span>
0465     posLast = length( cellData( rowIDX,:));
0466     <span class="keyword">while</span> isempty( cellData{ rowIDX,posLast } )
0467         posLast = posLast - 1;
0468     <span class="keyword">end</span>
0469     posNew = posLast + 1;
0470     cellData{ rowIDX, posNew } = answer{1};
0471     cellData{ rowIDX, posNew+1 } = paramvalue;
0472     <span class="comment">% Adapt column names if necessary</span>
0473     cnames = get(handles.t,<span class="string">'ColumnName'</span>);
0474     columneditable = get(handles.t,<span class="string">'ColumnEditable'</span>);
0475     <span class="keyword">if</span> length( cnames ) &lt; posNew+1
0476         <span class="comment">%do something</span>
0477         cnames{posNew} = <span class="string">'Parameter Name'</span>;
0478         cnames{posNew + 1} = <span class="string">'Value'</span>;
0479         columneditable(posNew) = false;
0480         columneditable(posNew + 1) = true;
0481         set(handles.t,<span class="string">'ColumnName'</span>,cnames);
0482         set(handles.t,<span class="string">'ColumnEditable'</span>,columneditable);
0483     <span class="keyword">end</span>
0484     <span class="comment">% Computing new positions</span>
0485     <a href="../../../mtids/subfunctions/newTablePosition.html" class="code" title="function newTablePosition( varargin )">newTablePosition</a>( handles,eventdata, get(handles.t,<span class="string">'RowName'</span>), cellData );
0486 <span class="keyword">end</span>
0487 
0488 
0489 <span class="comment">% --- Executes on button press in pushbutton4. REMOVE_PARAMETER</span>
0490 <a name="_sub6" href="#_subfunctions" class="code">function pushbutton4_Callback(hObject, eventdata, handles)</a>
0491 <span class="comment">% hObject    handle to pushbutton4 (see GCBO)</span>
0492 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0493 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0494 <span class="keyword">try</span>
0495     <span class="keyword">if</span> ~isfield(handles,<span class="string">'selected_cells'</span>) || isempty(handles.selected_cells)
0496         errordlg(<span class="string">'No row(s) selected'</span>);
0497         <span class="keyword">return</span>
0498     <span class="keyword">end</span>
0499     IDX = handles.selected_cells; <span class="comment">% Contains indices of the selected cells</span>
0500     <span class="keyword">if</span> <a href="../../../mtids/subfunctions/matgraph/@graph/size.html" class="code" title="function [sz,tz] = size(g)">size</a>( IDX,1 ) &gt; 1
0501        errordlg(<span class="string">'Please select only one cell to delete parameter values'</span>);
0502        <span class="keyword">return</span>
0503     <span class="keyword">end</span>
0504     rowIDX = IDX(1);
0505     colIDX = IDX(2);
0506     <span class="comment">%     rowname = get(handles.t,'RowName');</span>
0507     cellData = get(handles.t,<span class="string">'Data'</span>);
0508     <span class="comment">% Getting access to a specific block in the model, whose name is contained</span>
0509     <span class="comment">% in handles.sysname; the block name is contained in the first row</span>
0510 <span class="comment">%     get_param([handles.sysname '/' cellData{rowIDX,1}],'Dialogparameters');</span>
0511     <span class="keyword">if</span> colIDX == 1
0512         <a href="#_sub4" class="code" title="subfunction pushbutton2_Callback(hObject, eventdata, handles)">pushbutton2_Callback</a>(hObject, eventdata, handles);
0513     <span class="keyword">end</span>
0514     <span class="comment">% determine colIDXs to delete entries</span>
0515     <span class="keyword">if</span> rem( colIDX,2 ) == 0
0516         colIDX = [colIDX colIDX+1];
0517     <span class="keyword">else</span>
0518         colIDX = [colIDX-1 colIDX];
0519     <span class="keyword">end</span>
0520     <span class="keyword">if</span> or( isempty( cellData{rowIDX,colIDX(1)} ),<span class="keyword">...</span>
0521             isempty( cellData{rowIDX,colIDX(2)} ))
0522         errordlg(<span class="string">'No parameter contained in selected cell(s)'</span>);
0523         <span class="keyword">return</span>
0524     <span class="keyword">else</span>
0525         cellData{rowIDX,colIDX(1)} = [];
0526         cellData{rowIDX,colIDX(2)} = [];
0527         <span class="comment">% Check if table contains empty cols; if yes, remove them</span>
0528         <span class="keyword">if</span> all( all( cellfun(@isempty, cellData(:,colIDX(1:2)) ) ) )
0529             <span class="keyword">if</span> <a href="../../../mtids/subfunctions/matgraph/@graph/size.html" class="code" title="function [sz,tz] = size(g)">size</a>( cellData,2 ) &gt; colIDX(2)
0530                 <span class="comment">% shift all cols on the RHS to the left by 2</span>
0531                 cellData(:,colIDX(1):end-2) = cellData(:,colIDX(2)+1:end);
0532                 cellData = cellData(:,1:end-2);
0533             <span class="keyword">else</span>
0534                 <span class="comment">% simply remove these two cols</span>
0535                 cellData = cellData(:,1:colIDX(1)-1);               
0536             <span class="keyword">end</span>
0537         <span class="keyword">end</span>
0538         colNames = get(handles.t,<span class="string">'ColumnName'</span>);
0539         dimCellCols = <a href="../../../mtids/subfunctions/matgraph/@graph/size.html" class="code" title="function [sz,tz] = size(g)">size</a>( cellData,2 );
0540         colNames = colNames(1:dimCellCols);
0541         set(handles.t,<span class="string">'Data'</span>,cellData,<span class="string">'ColumnName'</span>,colNames);
0542     <span class="keyword">end</span>
0543     
0544 <span class="keyword">catch</span> <span class="comment">%#ok&lt;CTCH&gt;</span>
0545    <span class="comment">%</span>
0546 <span class="keyword">end</span>
0547 
0548 <span class="comment">% --- Executes on button press in pushbutton5. TESTING</span>
0549 <a name="_sub7" href="#_subfunctions" class="code">function pushbutton5_Callback(hObject, eventdata, handles) </a><span class="comment">%#ok&lt;*DEFNU&gt;</span>
0550 <span class="comment">% hObject    handle to pushbutton5 (see GCBO)</span>
0551 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0552 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0553 [dimension choice ME1 ME2] = <a href="../../../mtids/subfunctions/testingValueSet.html" class="code" title="function varargout = testingValueSet( varargin )">testingValueSet</a>( handles,0 );
0554 <span class="keyword">if</span> strcmp( choice, <span class="string">'yes'</span> )
0555     handles.testSuccess = 1;
0556     handles.dimension = dimension;
0557     guidata(handles.fig_importTemplate, handles);
0558     disp(<span class="string">'Parameter tested successfully'</span>);
0559 <span class="keyword">else</span>
0560     disp(<span class="string">'Testing failed. Maybe the following message will help you to find the error:'</span>);
0561     <span class="keyword">if</span> ~isempty(ME1)
0562         disp(ME1.message);
0563     <span class="keyword">end</span>
0564     <span class="keyword">if</span> ~isempty(ME2)
0565         disp(ME2.message);
0566     <span class="keyword">end</span>
0567 <span class="keyword">end</span>
0568 
0569 <span class="comment">% --- Executes on button press in pushbutton6 FINISHIMPORT</span>
0570 <a name="_sub8" href="#_subfunctions" class="code">function pushbutton6_Callback(hObject, eventdata, handles)</a>
0571 <span class="comment">% hObject    handle to pushbutton6 (see GCBO)</span>
0572 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0573 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0574 <span class="keyword">if</span> handles.testSuccess
0575     choice = <span class="string">'yes'</span>;
0576     dimension = handles.dimension;
0577 <span class="keyword">else</span>
0578     [dimension choice ] = <a href="../../../mtids/subfunctions/testingValueSet.html" class="code" title="function varargout = testingValueSet( varargin )">testingValueSet</a>( handles,0 );
0579 <span class="keyword">end</span>
0580 
0581 <span class="comment">% In case of being successful, store parameters</span>
0582 <span class="keyword">if</span> strcmp(choice,<span class="string">'yes'</span>)
0583     Data = get(handles.t,<span class="string">'Data'</span>);
0584     <span class="comment">% copy model to \import</span>
0585     <span class="comment">% ask for new filename</span>
0586     prompt = {<span class="string">'Enter name of imported template:'</span>};
0587     dlg_title = <span class="string">'Name of imported template'</span>;
0588     num_lines = 1;
0589     def = {handles.sysname};
0590     answer = inputdlg(prompt,dlg_title,num_lines,def);
0591     <span class="keyword">if</span> isempty(answer)
0592         <span class="keyword">return</span>
0593     <span class="keyword">end</span>
0594     pathname = [pwd filesep <span class="string">'import'</span> filesep];
0595     <span class="keyword">if</span> ~exist( [answer{1} <span class="string">'_CHECKED'</span>],<span class="string">'file'</span>)
0596         save_system( handles.sysname, [pathname answer{1} <span class="string">'_CHECKED'</span>]);
0597     <span class="keyword">end</span>
0598     <span class="comment">% copy also data=&gt;use existing table</span>
0599     [success errMessage ] = <a href="../../../mtids/subfunctions/saveParamSet2File.html" class="code" title="function varargout = saveParamSet2File( varargin )">saveParamSet2File</a>(handles.TextField1InputSpecs,<span class="keyword">...</span>
0600         handles.TextField2InputSpecs, answer{1}, handles.EditFieldSetName,<span class="keyword">...</span>
0601         Data, dimension, pathname);
0602     <span class="comment">% close figure</span>
0603     <span class="keyword">if</span> success
0604         bdclose;
0605         <a href="#_sub9" class="code" title="subfunction fig_importTemplate_CloseRequestFcn(hObject, eventdata, handles)">fig_importTemplate_CloseRequestFcn</a>(handles.fig_importTemplate, eventdata, handles);
0606     <span class="keyword">else</span>
0607         disp(<span class="string">'Could not save parameter set due to following reason:'</span>);
0608         <span class="keyword">if</span> ~isempty(errMessage)
0609            disp(errMessage); 
0610         <span class="keyword">end</span>
0611     <span class="keyword">end</span>
0612 <span class="keyword">else</span>
0613     disp(<span class="string">'Testing of parameter set failed.'</span>);
0614 <span class="keyword">end</span>
0615 
0616 <span class="comment">% --- Executes when user attempts to close fig_importTemplate.</span>
0617 <a name="_sub9" href="#_subfunctions" class="code">function fig_importTemplate_CloseRequestFcn(hObject, eventdata, handles)</a>
0618 <span class="comment">% hObject    handle to fig_importTemplate (see GCBO)</span>
0619 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0620 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0621 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0622 handles.OutputFlag = 1;
0623 guidata(hObject, handles);
0624 <span class="comment">%     uiresume(handles.fig_importTemplate);</span>
0625 <a href="../../../mtids/subfunctions/matgraph/@graph/delete.html" class="code" title="function delete(g,i,j,dir)">delete</a>(hObject);
0626      
0627 
0628 <a name="_sub10" href="#_subfunctions" class="code">function height = get_figureHeight( nrBlks )</a>
0629 <span class="comment">% Set the height of the figure</span>
0630 fixedHeight = 170 + 120; <span class="comment">% + 60 due to new elements</span>
0631 rowHeight = 25;
0632 height = fixedHeight + nrBlks*rowHeight;
0633 
0634 <span class="comment">% --- Executes when selected cell(s) is changed</span>
0635 <a name="_sub11" href="#_subfunctions" class="code">function table_CellSelectionCallback(src,evt,handles)</a>
0636 handles.selected_cells = evt.Indices;
0637 guidata(src, handles);
0638 
0639 <span class="comment">% --- Executes when cell(s) is (are) edited</span>
0640 <a name="_sub12" href="#_subfunctions" class="code">function table_CellEditCallbackFcn(src,evt,handles) </a><span class="comment">%#ok&lt;*INUSL&gt;</span>
0641 <span class="comment">% success = 0;</span>
0642 <span class="comment">% Get indices of edited cell</span>
0643 IDX = evt.Indices;
0644 rowIDX = IDX(1);
0645 colIDX = IDX(2);
0646 cellData = get(handles.t,<span class="string">'Data'</span>);
0647 success = <a href="../../../mtids/subfunctions/isValidData.html" class="code" title="function varargout = isValidData( varargin )">isValidData</a>( handles, rowIDX, colIDX );
0648 <span class="keyword">if</span> ~success
0649     errordlg(<span class="string">'Parameter value not possible'</span>);
0650     <span class="comment">% Restore old data</span>
0651     cellData{ rowIDX,colIDX } = evt.PreviousData;
0652     set(handles.t,<span class="string">'Data'</span>,cellData);
0653 <span class="keyword">end</span>
0654 
0655 
0656 <a name="_sub13" href="#_subfunctions" class="code">function geo_params = get_initialGeometry</a>
0657 screenSize = get( 0, <span class="string">'ScreenSize'</span> );
0658 geo_params.topFrame = 30;
0659 geo_params.bottomFrame = 0.5*geo_params.topFrame;
0660 geo_params.sideFrame = 0.5*geo_params.topFrame;
0661 <span class="keyword">if</span> screenSize(3)*0.9 &gt; 760
0662     geo_params.width = 760;
0663 <span class="keyword">else</span>
0664     geo_params.width = screenSize(3)*0.85;
0665 <span class="keyword">end</span>
0666 
0667 <a name="_sub14" href="#_subfunctions" class="code">function TextField2InputSpecs_Callback( src,evt,handles )</a>
0668 temp = str2double( get(handles.TextField2InputSpecs,<span class="string">'String'</span>));
0669 <span class="keyword">if</span> isnan( temp ) || rem(temp,1) || temp &lt; 0
0670     errordlg(<span class="string">'Number of internal inputs must be a non-negative integer value'</span>);
0671     set(handles.TextField2InputSpecs,<span class="string">'String'</span>,num2str(0));
0672 <span class="keyword">end</span>
0673 
0674 <a name="_sub15" href="#_subfunctions" class="code">function EditFieldSetName_Callback( src,evt,handles )</a>
0675 
0676 
0677 <span class="comment">%%%%%ENDOFSCRIPT%%%%%%%%%%%</span></pre></div>
<hr><address>Generated on Mon 01-Oct-2012 17:13:50 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>